<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Copilot Chat UI</title>
    <link rel="stylesheet" href="./css/style.css" />
</head>
<body>
<h3 style="color: #0078D4"><center>
<pre> dP"8           888                         d8b           e88'Y88                    ,e, 888             d8
C8b Y  e88 88e  888 ee   ,"Y88b 888 888 8e  Y8P  dP"Y    d888  'Y  e88 88e  888 88e   "  888  e88 88e   d88
 Y8b  d888 888b 888 88b "8" 888 888 888 88b ,P  C88b    C8888     d888 888b 888 888b 888 888 d888 888b d88888
b Y8D Y888 888P 888 888 ,ee 888 888 888 888 P    Y88D    Y888  ,d Y888 888P 888 888P 888 888 Y888 888P  888
8edP   "88 88"  888 888 "88 888 888 888 888     d,dP      "88,d88  "88 88"  888 88"  888 888  "88 88"   888
                                                                            888
                                                                            888                               </pre>

</center>
</h3>
<div class="chat-container">
    <div class="chat-header">ðŸ§  Copilot</div>

    <div class="chat-messages" id="chatMessages">
        <div class="message assistant">
            <div class="bubble">Welcome back, Soham! Ready to scaffold todayâ€™s module?</div>
        </div>
        <div class="message user">
            <div class="bubble">Letâ€™s start with Spring AI integration.</div>
        </div>
        <!-- Add more messages here -->
    </div>

    <div class="chat-input">
        <input type="text" placeholder="Type your message..." />
        <button>Send</button>
    </div>
</div>
<script>
    const inputField = document.querySelector('.chat-input input');
    const sendButton = document.querySelector('.chat-input button');
    const chatMessages = document.getElementById('chatMessages');

    sendButton.addEventListener('click', () => {
      const userText = inputField.value.trim();
      if (userText === '') return;

      // Create user message bubble
      const messageDiv = document.createElement('div');
      messageDiv.classList.add('message', 'user');

      const bubbleDiv = document.createElement('div');
      bubbleDiv.classList.add('bubble');
      bubbleDiv.textContent = userText;

      messageDiv.appendChild(bubbleDiv);
      chatMessages.appendChild(messageDiv);

      // Auto-scroll to bottom
      chatMessages.scrollTop = chatMessages.scrollHeight;

      // Clear input
      inputField.value = '';

      const source = new EventSource('http://localhost:8080/chatV2/streamChat?prompt='+encodeURIComponent(userText));
assistantMessageDiv =null;
assistantBubbleDiv =null;
source.onmessage = function(event) {
    console.log('New message:', event);
    if(null=== assistantMessageDiv){
               assistantMessageDiv = document.createElement('div');

              assistantMessageDiv.classList.add('message', 'assistant');

               assistantBubbleDiv = document.createElement('div');
              assistantBubbleDiv.classList.add('bubble');


              assistantMessageDiv.appendChild(assistantBubbleDiv);
              chatMessages.appendChild(assistantMessageDiv);
              chatMessages.scrollTop = chatMessages.scrollHeight;
}
 assistantBubbleDiv.textContent +=' '+ event.data;
};

source.onerror = function(err) {
  console.error('SSE error:', err);
};
source.addEventListener('done', (event) => {
  console.log('Stream ended:', event.data);
  source.close();
});

});

</script>
</body>
</html>
